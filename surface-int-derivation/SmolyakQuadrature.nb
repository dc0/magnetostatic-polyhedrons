(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     22891,        572]
NotebookOptionsPosition[     22056,        543]
NotebookOutlinePosition[     22513,        561]
CellTagsIndexPosition[     22470,        558]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"On", "[", "Assert", "]"}], "\n", 
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Append", "[", 
     RowBox[{"$Path", ",", 
      RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"<<", "SmolyakQuadrature`"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Plot", " ", "the", " ", "number", " ", "of", " ", "accurate", " ", 
    "digits", " ", "of", " ", "Gaussian", " ", "integration", " ", "of", " ", 
    
    RowBox[{"Cos", "[", "x", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"prec", "=", "100"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"gint", "[", 
                RowBox[{"Cos", ",", "k", ",", "prec"}], "]"}], "-", 
               RowBox[{"Sin", "[", "1", "]"}]}], "]"}], ",", "prec"}], 
            "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "20"}], "}"}]}], "]"}]}], "]"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{
    "PlotLabel", "\[Rule]", 
     "\"\<Gauss-Legendre quadrature of cos(x): accurate digits\>\""}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<order\>\"", ",", "\"\<digits\>\""}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5253542292060213`*^9, 3.525354304662215*^9}, {
   3.525354341238079*^9, 3.5253543457502403`*^9}, {3.525354378958482*^9, 
   3.5253545143638277`*^9}, 3.525356185285972*^9, {3.5254198609866943`*^9, 
   3.525419882232895*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQEf7KuFs/wfCn+3hwo4dNxPnFM0idcBwuVw4Cm+
K+9aKgnlCziwL9BxSJ6nBOWLOHyfo36S6a0GlC/h0KGby9A9UR/Kl3HYc4ux
66edMZSv4LCyS22NyBUzKF/JIXrLpkifFisoX8Uhu+7nn1U+dlC+mkOKp4hf
hqgjlK/h8GZJkkkqnzOUr+WwQyX/VrWAK5Sv43AgRmDabyl3KF/PYa9X9AYf
XU8o38AhK+1W8Ws3byjf0OHI5BclKem+UL6Rw561wTsC+/yhfGOHbZeKbNfc
DYDyTRw+nb23Xfh7oAMA/zNPrQ==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{
    FormBox["\"order\"", TraditionalForm], 
    FormBox["\"digits\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  Method->{},
  PlotLabel->FormBox[
   "\"Gauss-Legendre quadrature of cos(x): accurate digits\"", 
    TraditionalForm],
  PlotRange->{{0, 20.}, {0, 71.86057850607156}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0.4, 0.4}, {1.4372115701214312`, 
   1.4372115701214312`}}]], "Output",
 CellChangeTimes->{{3.5253543050371103`*^9, 3.525354347057263*^9}, {
   3.525354380097974*^9, 3.525354443065736*^9}, {3.525354499436564*^9, 
   3.525354544954383*^9}, 3.525356208655449*^9, 3.525356287447136*^9, 
   3.525368713698592*^9, 3.525369542019265*^9, 3.52537966399297*^9, 
   3.525419498445613*^9, {3.525419862780748*^9, 3.525419883348444*^9}, 
   3.525421317910913*^9, 3.5254308963540287`*^9, 3.52543150139987*^9, 
   3.525431941458354*^9, 3.525438849144829*^9, 3.525442330423691*^9, 
   3.571133395327389*^9, 3.571133689558206*^9, 3.571137434461082*^9, 
   3.5714777721724377`*^9, 3.5714806197322702`*^9, 3.5744273009119177`*^9, {
   3.57443117712119*^9, 3.574431200719387*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkAccuracyOrder", "[", 
   RowBox[{"gw", ",", "10", ",", "100", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"2", "#"}], "-", "1"}], "&"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.525354610009197*^9, 3.525354887572607*^9}, {
   3.52535630770997*^9, 3.5253563392297792`*^9}, {3.5253781557793217`*^9, 
   3.525378258565462*^9}, {3.525378310726058*^9, 3.525378329039296*^9}, {
   3.525378881369606*^9, 3.5253788885542*^9}, {3.5254370588982058`*^9, 
   3.525437416366063*^9}, {3.5254375042847233`*^9, 3.525437815053823*^9}, {
   3.5254378769428387`*^9, 3.5254378784853497`*^9}, 3.5254379692995453`*^9, {
   3.525438507608039*^9, 3.525438528552986*^9}, {3.525438866974958*^9, 
   3.525438956875321*^9}, {3.525439023813325*^9, 3.525439114032723*^9}, {
   3.525439144727395*^9, 3.525439170266057*^9}, {3.525439278824566*^9, 
   3.525439418300009*^9}, {3.525441095178681*^9, 3.5254411210447197`*^9}, {
   3.5254411807571287`*^9, 3.5254413205498247`*^9}, {3.5254420784437733`*^9, 
   3.525442078689269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "that", " ", "KP", " ", "abscissas", " ", "are", " ", 
    "nested"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Assert", "[", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"kpAbscissas", "[", 
        RowBox[{"n", ",", "20"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"Length", "[", 
       RowBox[{"Intersection", "[", 
        RowBox[{
         RowBox[{"kpAbscissas", "[", 
          RowBox[{"n", ",", "20"}], "]"}], ",", 
         RowBox[{"kpAbscissas", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", "20"}], "]"}]}], "]"}], "]"}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.525421164905551*^9, 3.525421223799015*^9}, {
   3.525421266220546*^9, 3.525421287680807*^9}, {3.525421370620323*^9, 
   3.525421371962298*^9}, {3.52542144883466*^9, 3.5254216707239227`*^9}, {
   3.5254248032995234`*^9, 3.525424856247138*^9}, {3.525424962168174*^9, 
   3.5254250111593037`*^9}, {3.525425068342497*^9, 3.525425068886413*^9}, 
   3.5254251175436907`*^9, {3.525425199711019*^9, 3.525425223514881*^9}, {
   3.525425278662483*^9, 3.525425341859516*^9}, {3.525425462672598*^9, 
   3.525425503715302*^9}, {3.525425551487659*^9, 3.525425589175935*^9}, {
   3.525425657366796*^9, 3.525425690987567*^9}, {3.525426318786619*^9, 
   3.525426319329915*^9}, {3.525431570232321*^9, 3.5254316636977262`*^9}, {
   3.5254317015020857`*^9, 3.525431728249688*^9}, {3.5254317899767857`*^9, 
   3.5254318000982122`*^9}, {3.525431955256947*^9, 3.525432098415016*^9}, {
   3.5254325096957703`*^9, 3.525432510753839*^9}, {3.525432680410347*^9, 
   3.5254329192090187`*^9}, {3.5254329901110477`*^9, 3.525433024400722*^9}, {
   3.525433150714046*^9, 3.5254332151327467`*^9}, {3.5254332746601057`*^9, 
   3.525433278307955*^9}, 3.525433317910886*^9, {3.5254334760504637`*^9, 
   3.5254336029232397`*^9}, 3.525433639274872*^9, {3.525433771708169*^9, 
   3.5254337751976233`*^9}, {3.525433807292491*^9, 3.5254338114157267`*^9}, {
   3.525433888980872*^9, 3.525433918804842*^9}, {3.52543401409438*^9, 
   3.525434043936483*^9}, {3.525434090942317*^9, 3.525434152314167*^9}, {
   3.5254341925480413`*^9, 3.525434273521489*^9}, {3.5254344763541603`*^9, 
   3.525434525450694*^9}, {3.525434682489089*^9, 3.525434751263319*^9}, {
   3.525436608273535*^9, 3.525436609143282*^9}, {3.5254366823611183`*^9, 
   3.525436761830139*^9}, {3.525436795106771*^9, 3.5254368522179403`*^9}, {
   3.525436921071907*^9, 3.525436938933001*^9}, {3.525436980171874*^9, 
   3.5254370229942217`*^9}, {3.525438663587508*^9, 3.5254386695159283`*^9}, {
   3.525441816995533*^9, 3.525441834500278*^9}, {3.525442135220099*^9, 
   3.525442135426399*^9}}],

Cell[BoxData[{
 RowBox[{"Assert", "[", 
  RowBox[{
   RowBox[{"accuracyOrder", "[", 
    RowBox[{"kp", ",", "1", ",", "20"}], "]"}], "\[Equal]", "1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Assert", "[", 
  RowBox[{
   RowBox[{"accuracyOrder", "[", 
    RowBox[{"kp", ",", "2", ",", "20"}], "]"}], "\[Equal]", "5"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Assert", "[", 
  RowBox[{
   RowBox[{"accuracyOrder", "[", 
    RowBox[{"kp", ",", "3", ",", "20"}], "]"}], "\[Equal]", "11"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Assert", "[", 
  RowBox[{
   RowBox[{"accuracyOrder", "[", 
    RowBox[{"kp", ",", "4", ",", "20"}], "]"}], "\[Equal]", "23"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Assert", "[", 
  RowBox[{
   RowBox[{"accuracyOrder", "[", 
    RowBox[{"kp", ",", "5", ",", "20"}], "]"}], "\[Equal]", "47"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.525421164905551*^9, 3.525421223799015*^9}, {
   3.525421266220546*^9, 3.525421287680807*^9}, {3.525421370620323*^9, 
   3.525421371962298*^9}, {3.52542144883466*^9, 3.5254216707239227`*^9}, {
   3.5254248032995234`*^9, 3.525424856247138*^9}, {3.525424962168174*^9, 
   3.5254250111593037`*^9}, {3.525425068342497*^9, 3.525425068886413*^9}, 
   3.5254251175436907`*^9, {3.525425199711019*^9, 3.525425223514881*^9}, {
   3.525425278662483*^9, 3.525425341859516*^9}, {3.525425462672598*^9, 
   3.525425503715302*^9}, {3.525425551487659*^9, 3.525425589175935*^9}, {
   3.525425657366796*^9, 3.525425690987567*^9}, {3.525426318786619*^9, 
   3.525426319329915*^9}, {3.525431570232321*^9, 3.5254316636977262`*^9}, {
   3.5254317015020857`*^9, 3.525431728249688*^9}, {3.5254317899767857`*^9, 
   3.5254318000982122`*^9}, {3.525431955256947*^9, 3.525432098415016*^9}, {
   3.5254325096957703`*^9, 3.525432510753839*^9}, {3.525432680410347*^9, 
   3.5254329192090187`*^9}, {3.5254329901110477`*^9, 3.525432990241064*^9}, {
   3.525433020694429*^9, 3.5254330209102087`*^9}, {3.5254379095421963`*^9, 
   3.525438022149642*^9}, {3.525438366618959*^9, 3.525438399490149*^9}, {
   3.52543854125662*^9, 3.525438706086749*^9}, {3.5254413536119947`*^9, 
   3.5254415273963537`*^9}, {3.5254421315772257`*^9, 3.525442131866578*^9}}],

Cell[BoxData[
 RowBox[{"Assert", "[", 
  RowBox[{
   RowBox[{"Min", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"accuracyOrder", "[", 
        RowBox[{
         RowBox[{"kpDelay", "[", "delayFull", "]"}], ",", "n", ",", "20"}], 
        "]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "n"}], "-", "1"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "delayFull", "]"}]}], "}"}]}], "]"}], "]"}], 
   "\[GreaterEqual]", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.525443711977075*^9, 3.5254437194035187`*^9}, {
  3.525443799820313*^9, 3.52544419518854*^9}, {3.525444239868759*^9, 
  3.525444245170661*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "that", " ", "the", " ", "quadrature", " ", "formula", " ", 
    "is", " ", "the", " ", "same", " ", "as", " ", "gw", " ", "for", " ", 
    "legendre", " ", "polynomial", " ", "roots"}], " ", "*)"}], "\n", 
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"roundPrec", "[", 
      RowBox[{
       RowBox[{"quadrature", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"legendreRoots", "[", "10", "]"}], "+", "1"}], ")"}], "/",
           "2"}], ",", "40"}], "]"}], ",", "20"}], "]"}], "-", 
     RowBox[{"roundPrec", "[", 
      RowBox[{
       RowBox[{"gw", "[", 
        RowBox[{"10", ",", "40"}], "]"}], ",", "20"}], "]"}]}], "==", "0"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"CC", " ", "formulas"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"ccAbscissas", ",", "ccM", ",", "cc"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ccM", "[", "1", "]"}], ":=", "1"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ccM", "[", "n_", "]"}], ":=", 
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"n", "-", "1"}]], "+", "1"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ccAbscissas", "[", 
     RowBox[{"1", ",", "prec_"}], "]"}], ":=", 
    RowBox[{"{", "0", "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ccAbscissas", "[", 
     RowBox[{"n_", ",", "prec_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"Pi", " ", 
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}]}], 
           RowBox[{
            RowBox[{"ccM", "[", "n", "]"}], "-", "1"}]], "]"}]}], ",", 
        "prec"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"ccM", "[", "n", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cc", "[", 
     RowBox[{"n_", ",", "prec_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"cc", "[", 
      RowBox[{"n", ",", "prec"}], "]"}], "=", 
     RowBox[{"iteratePrec", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"quadrature", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ccAbscissas", "[", 
              RowBox[{"n", ",", "prec"}], "]"}], "+", "1"}], ")"}], "/", 
           "2"}], ",", "#"}], "]"}], "&"}], ",", "prec"}], 
      "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.5714777694907923`*^9, 3.571477776567418*^9}, 
   3.571478054459015*^9, {3.57147810578098*^9, 3.571478118715578*^9}, {
   3.571478202787436*^9, 3.571478246749277*^9}, {3.571478284429335*^9, 
   3.571478430396879*^9}, {3.571478519499628*^9, 3.571478687713162*^9}, {
   3.5714790353742123`*^9, 3.5714790419670763`*^9}, {3.571479085018968*^9, 
   3.571479141537608*^9}, {3.5714791776153193`*^9, 3.571479177797398*^9}, {
   3.571479549571519*^9, 3.571479557464829*^9}, 3.571479626142167*^9, {
   3.571479689847342*^9, 3.57147984250248*^9}, {3.571480279828746*^9, 
   3.571480280633803*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "that", " ", "CC", " ", "abscissas", " ", "are", " ", 
    "nested"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"ccAbscissas", "[", 
         RowBox[{"n", ",", "20"}], "]"}], "]"}], "\[Equal]", 
       RowBox[{"Length", "[", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"ccAbscissas", "[", 
           RowBox[{"n", ",", "20"}], "]"}], ",", 
          RowBox[{"ccAbscissas", "[", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ",", "20"}], "]"}]}], "]"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Check", " ", "the", " ", "accuracy", " ", "order", " ", "of", " ", "the",
      " ", "CC", " ", "formulas"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"checkAccuracyOrder", "[", 
     RowBox[{"cc", ",", "6", ",", "30", ",", 
      RowBox[{
       RowBox[{"ccM", "[", "#", "]"}], "&"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5714777694907923`*^9, 3.571477776567418*^9}, 
   3.571478054459015*^9, {3.57147810578098*^9, 3.571478118715578*^9}, {
   3.571478202787436*^9, 3.571478246749277*^9}, {3.571478284429335*^9, 
   3.571478430396879*^9}, {3.571478519499628*^9, 3.571478687713162*^9}, {
   3.5714790353742123`*^9, 3.5714790419670763`*^9}, {3.571479085018968*^9, 
   3.571479141537608*^9}, {3.5714807209031363`*^9, 3.571480794778017*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"check", " ", "the", " ", "4", "d", " ", "rule"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"ecfRule", "[", "rule4d9k145", "]"}], "]"}], "\[Equal]", 
     "145"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"1", "-", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"to01cube4d", "[", 
          RowBox[{"ecfRule", "[", "rule4d9k145", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "30"}]]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"Precision", "[", 
      RowBox[{"to01cube4d", "[", 
       RowBox[{"ecfRule", "[", "rule4d9k145", "]"}], "]"}], "]"}], ">", 
     "29"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"check", " ", "the", " ", "tetrahedral", " ", "rule"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"ecfRule", "[", "simplex3d8k43", "]"}], "]"}], "\[Equal]", 
     "43"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"6", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"ecfRule", "[", "simplex3d8k43", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "-", "1"}], 
      "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "30"}]]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ecfRule", "[", "simplex3d8k43", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"2", ";;"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "-", "1"}], "]"}], "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "30"}]]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"check", " ", "the", " ", "triangle", " ", "rule"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"ecfRule", "[", "simplex2d10k25a", "]"}], "]"}], "\[Equal]", 
     "25"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"ecfRule", "[", "simplex2d10k25a", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "-", "1"}], 
      "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "30"}]]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ecfRule", "[", "simplex2d10k25a", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"2", ";;"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "-", "1"}], "]"}], "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "30"}]]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.574427309328017*^9, 3.574427321930242*^9}, {
   3.574427467702631*^9, 3.574427756255383*^9}, {3.574427894463656*^9, 
   3.5744279051826057`*^9}, {3.574427979390065*^9, 3.5744281754013033`*^9}, {
   3.574428241671245*^9, 3.5744282481156397`*^9}, {3.574428298025175*^9, 
   3.5744283584731913`*^9}, {3.574428555840427*^9, 3.574428705983354*^9}, {
   3.574428802213121*^9, 3.5744288319645042`*^9}, {3.574428873316662*^9, 
   3.5744289026676188`*^9}, {3.574428944021201*^9, 3.574429013375115*^9}, {
   3.57442905724813*^9, 3.574429299693782*^9}, {3.574429377307588*^9, 
   3.574429548799739*^9}, {3.574429658534594*^9, 3.574429744766124*^9}, {
   3.5744297784141417`*^9, 3.574429840982482*^9}, {3.5744304246420116`*^9, 
   3.574430451255831*^9}, {3.574430653206915*^9, 3.5744308758003263`*^9}, {
   3.574430934433035*^9, 3.574431121260499*^9}, {3.5744313011592207`*^9, 
   3.574431335278761*^9}, {3.574431438168686*^9, 3.5744314487278547`*^9}, 
   3.574431534567973*^9, {3.5744316008403873`*^9, 3.5744316482891827`*^9}, {
   3.57597808869629*^9, 3.575978107048636*^9}, {3.5759782081294394`*^9, 
   3.575978229112651*^9}, {3.575978261486961*^9, 3.5759784054033003`*^9}, 
   3.575978456423917*^9, {3.57597849476862*^9, 3.575978580408762*^9}, {
   3.5759786162977057`*^9, 3.575978780665451*^9}, {3.5759788106991367`*^9, 
   3.575978923316244*^9}, {3.5759789894150877`*^9, 3.5759789908070107`*^9}, {
   3.575979061789091*^9, 3.575979065233356*^9}, {3.5759801272091208`*^9, 
   3.575980133183847*^9}, {3.575981696810495*^9, 3.5759817083214207`*^9}, {
   3.575981745939067*^9, 3.575981908168099*^9}, {3.576062936402648*^9, 
   3.57606294214461*^9}, {3.57606813879799*^9, 3.576068189707933*^9}, {
   3.576068398245935*^9, 3.576068458396729*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"intTet", "[", 
   RowBox[{
    RowBox[{"1", "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intTri", "[", 
   RowBox[{
    RowBox[{"1", "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.576233147362751*^9, 3.5762334256318617`*^9}, {
  3.576233533708453*^9, 3.576233599100203*^9}, {3.576233853513166*^9, 
  3.5762338646646423`*^9}}]
},
WindowSize->{1680, 994},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 307, 9, 89, "Input"],
Cell[CellGroupData[{
Cell[889, 33, 1560, 40, 139, "Input"],
Cell[2452, 75, 1639, 33, 320, "Output"]
}, Open  ]],
Cell[4106, 111, 1046, 18, 39, "Input"],
Cell[5155, 131, 2814, 51, 64, "Input"],
Cell[7972, 184, 2195, 43, 139, "Input"],
Cell[10170, 229, 710, 20, 39, "Input"],
Cell[10883, 251, 815, 23, 64, "Input"],
Cell[11701, 276, 2425, 65, 229, "Input"],
Cell[14129, 343, 1637, 39, 114, "Input"],
Cell[15769, 384, 5274, 124, 341, "Input"],
Cell[21046, 510, 1006, 31, 64, "Input"]
}
]
*)

(* End of internal cache information *)
